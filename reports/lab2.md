<!--
 * @Author: 7erry
 * @Date: 2024-11-07 19:07:47
 * @LastEditTime: 2024-11-07 19:41:49
 * @Description: 
-->
# Lab2

## 实现功能

- 重写 `sys_get_time` 和 `sys_task_info`，实现了内核地址空间到应用地址空间的拷贝。
- 实现了 `mmap` 和 `munmap` 两种 syscall

## 简答

1.  
    - 有效位（Valid Bit, V）：指示该页表项是否有效。如果有效位为 0，则该页表项无效，访问该虚拟地址会导致缺页异常。
    - 只读位（Read Bit, R）：指示该页面是否允许读取。如果为 0，表示该页面不允许读取。
    - 可写位（Write Bit, W）：指示该页面是否允许写入。如果为 0，表示该页面为只读。
    - 可执行位（Execute Bit, X）：指示该页面是否允许执行。如果为 0，表示该页面不可执行。
    - 用户模式位（User Bit, U）：指示该页面是否可以被用户模式访问。如果为 0，则只有特权模式可以访问该页面。
    - 访问位（Accessed Bit, A）：在访问该页面时由硬件设置，表示该页面是否被访问过。
    - 脏位（Dirty Bit, D）：在页面被写入时由硬件设置，表示该页面是否被修改过。
    - RSW（Reserved Software）：保留供软件使用。
    - 物理页号（Physical Page Number, PPN）：用于指向实际物理内存中的页框，包含页框的高位部分。
2.  
    1. Q1
       1. 缺页异常（Page Fault）、写入保护异常（Write Protection Fault）、用户访问异常（User Access Violation）、非法地址异常（Invalid Address Fault）
       2. 相关寄存器
           - scause: 中断/异常发生时， CSR 寄存器 scause 中会记录其信息， Interrupt 位记录是中断还- 是异常， Exception Code 记录中断/异常的种类。
           - sstatus: 记录处理器当前状态，其中 SPP 段记录当前特权等级。
           - stvec: 记录处理 trap 的入口地址。
           - sscratch: 其中的值是指向hart相关的S态上下文的指针，比如内核栈的指针。
           - sepc: trap 发生时会将当前指令的下一条指令地址写入其中，用于 trap 处理完成后返回。
           - stval: trap 发生进入S态时会将异常信息写入，用于帮助处理 trap ，其中会保存导致缺页异常的虚拟地址。
    2. Q2
       1. 更快
    3. Q3
       1. 20MB。
       2. 不访问不分配
    4. Q4
       1. 页面失效会将标志位`V`置为`0`。
3.  
    1. 在切换用户程序时更换页表
    2. 修改 pet `U` 标志位为 0  
    3. 处理trap，系统调用时无需切换页表，速度快  
    4. 用户态与内核态切换任务时；切换所有任务时

## 荣誉准则

1. 在完成本次实验的过程（含此前学习的过程）中，我曾分别与 **以下各位** 就（与本次实验相关的）以下方面做过交流，还在代码中对应的位置以注释形式记录了具体的交流对象及内容：

    ChatGPT

2. 此外，我也参考了 **以下资料** ，还在代码中对应的位置以注释形式记录了具体的参考来源及内容：

3. 我独立完成了本次实验除以上方面之外的所有工作，包括代码与文档。
我清楚地知道，从以上方面获得的信息在一定程度上降低了实验难度，可能会影响起评分。

4. 我从未使用过他人的代码，不管是原封不动地复制，还是经过了某些等价转换。
我未曾也不会向他人（含此后各届同学）复制或公开我的实验代码，我有义务妥善保管好它们。
我提交至本实验的评测系统的代码，均无意于破坏或妨碍任何计算机系统的正常运转。
我清楚地知道，以上情况均为本课程纪律所禁止，若违反，对应的实验成绩将按“-100”分计。
